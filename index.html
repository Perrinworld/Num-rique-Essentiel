<!DOCTYPE html>
<html lang = "fr">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <title>
            Tâche Eco-Conçues 
        </title>
        <h1>Bienvenu, Utilisateur</h1>
        voici un outils de productivité qui vous aide à suivre vos tâches de manière éco-responsables.
        Avec nous, vous pouvez :
        
        <ul>
            <li>Réduire votre empreinte carbone</li>
            <li>Planter des arbres</li>
            <li>Suivre éfficacement vos différentes tâches</li>
        </ul>
    </head>

    <body>

        <form id="task-form">
            <label for="new-task" style="position: absolute; left: -9999px;">Ajouter une nouvelle tâche</label>
            <input type="text" id="new-task" placeholder="Entrer une nouvelle tâche..." required>
            <button type="submit">Ajouter</button>
        </form>
        <ul id="task-list">
        </ul>
        <script>
            const form = document.getElementById('task-form');
        const input = document.getElementById('new-task');
        const list = document.getElementById('task-list'); 

        function getTasks() {
        // localStorage.getItem('tasks') retourne la chaîne JSON stockée
        const tasksJSON = localStorage.getItem('tasks');
        return tasksJSON ? JSON.parse(tasksJSON) : [];
    }

    /**
     * Sauvegarde le tableau de tâches actuel dans le localStorage.
     */
    function saveTasks(tasks) {
        // JSON.stringify() convertit l'objet JavaScript (tableau) en chaîne JSON
        localStorage.setItem('tasks', JSON.stringify(tasks));
    }

    function loadTasks() 
    {
        const tasks = getTasks();
        tasks.forEach(task => {
            addTaskToDOM(task.text, task.completed);
        });
    }

    function addTaskToDOM(text) 
   {
        const listItem = document.createElement('li');
        listItem.innerHTML = `
        <span class="task-indicator"></span> 
        <span class="task-text">${text}</span> 
        <div>
        <button class="delete-btn">Supprimer</button>
        </div>`;
            list.appendChild(listItem);
        }

       form.addEventListener('submit', (e) => 
        {
            e.preventDefault(); 
            const taskText = input.value.trim();
            if (taskText) {
            // 1. AJOUTER AU DOM
            addTaskToDOM(taskText);
                
                // 2. SAUVEGARDER DANS LE LOCAL STORAGE (CORRECTION)
                const tasks = getTasks();
                // On ajoute la nouvelle tâche à la liste avec son état initial (non fait)
                tasks.push({ text: taskText, completed: false }); 
                saveTasks(tasks); 
                
            input.value = ''; 
            input.focus();
        }
        });
        list.addEventListener('click', (e) => 
        {
            const target = e.target;
            if (target.classList.contains('delete-btn')) {
            const listItem = target.closest('li'); 
        
            if (listItem) 
            {
                let tasks = getTasks();
                const taskText = listItem.querySelector('.task-text').textContent;
            
                tasks = tasks.filter(task => task.text !== taskText);
                saveTasks(tasks);
                listItem.remove(); 
            }
            }
        });
        loadTasks();
        </script>
        <footer>
        <p><small>
            Défi Éco-conception | Inspiré par le protocole Gemini.
            Conçu par Daniel et Perrin
        </small></p>
        </footer>
    </body>



</html>